<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shopping Bag – Trendify</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="cart.css">
</head>

<body>
  <!-- HEADER -->
  <header class="navbar">
    <div class="nav-container">
      <nav class="main-nav">
        <!-- MEN -->
        <div class="dropdown">
          <input type="checkbox" id="men-toggle" class="toggle">
          <label for="men-toggle">MEN</label>
          <div class="dropdown-area">
            <div class="section">
              <label>CLOTHING</label>
              <div class="sub-menu">
                <a href="men.html?category=shirts">SHIRTS</a>
                <a href="men.html?category=jackets">JACKETS</a>
                <a href="men.html?category=jeans">JEANS</a>
              </div>
            </div>
            <div class="section">
              <label>ACCESSORIES</label>
              <div class="sub-menu">
                <a href="men.html?category=shoes">SHOES</a>
                <a href="men.html?category=bags">BAGS</a>
                <a href="men.html?category=jewelry">JEWELRY</a>
              </div>
            </div>
          </div>
        </div>

        <!-- WOMEN -->
        <div class="dropdown">
          <input type="checkbox" id="women-toggle" class="toggle">
          <label for="women-toggle">WOMEN</label>
          <div class="dropdown-area">
            <div class="section">
              <label>CLOTHING</label>
              <div class="sub-menu">
                <a href="women.html?category=tops">TOPS</a>
                <a href="women.html?category=dresses">DRESSES</a>
                <a href="women.html?category=skirts">SKIRTS</a>
              </div>
            </div>
            <div class="section">
              <label>SHOES & ACCESSORIES</label>
              <div class="sub-menu">
                <a href="women.html?category=heels">HEELS</a>
                <a href="women.html?category=bags">BAGS</a>
                <a href="women.html?category=jewelry">JEWELRY</a>
              </div>
            </div>
          </div>
        </div>
      </nav>

      <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, Helvetica, sans-serif; }
        body { background: #fff; }

        /* HEADER */
        .navbar {
          position: sticky;
          top: 0;
          z-index: 9999;
          background: #fff;
          padding: 14px 40px;
          border-bottom: 1px solid #e7e7e7;
          display: flex;
          justify-content: center;
          align-items: center;
        }
        .nav-container {
          width: 100%;
          max-width: 1400px;
          display: grid;
          grid-template-columns: 1fr auto 1fr;
          align-items: center;
        }
        .main-nav { display: flex; align-items: center; gap: 35px; }
        .main-nav label, .main-nav a {
          font-size: 18px;
          font-weight: bold;
          letter-spacing: 1px;
          text-decoration: none;
          color: #000;
          cursor: pointer;
        }
        .logo { width: 70px; display: block; margin: 0 auto; }
        .nav-right {
          display: flex;
          justify-content: flex-end;
          align-items: center;
          gap: 22px;
        }
        .nav-right i { font-size: 22px; color: #000; cursor: pointer; }
        .cart-count {
          position: absolute;
          top: -6px;
          right: -10px;
          background: #000;
          color: #fff;
          border-radius: 999px;
          font-size: 11px;
          padding: 2px 6px;
          display: none;
        }

        /* DROPDOWN */
        .dropdown { position: relative; }
        .toggle { display: none; }
        .toggle:checked + label + .dropdown-area { display: flex; }
        .dropdown-area {
          position: absolute;
          top: 100%;
          left: 0;
          width: 260px;
          background: #fff;
          border-right: 1px solid #ddd;
          padding: 25px 20px 25px 20px;
          padding-right: 35px;
          display: none;
          flex-direction: column;
          gap: 22px;
          box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        .section label {
          font-size: 15px;
          font-weight: bold;
          text-transform: uppercase;
          cursor: pointer;
        }
        .sub-menu {
          display: none;
          flex-direction: column;
          gap: 8px;
          margin-top: 8px;
          padding-left: 12px;
          border-left: 2px solid #000;
        }
        .section:hover .sub-menu { display: flex; }
        .sub-menu a {
          font-size: 14px;
          font-weight: bold;
          text-transform: uppercase;
          color: #000;
          text-decoration: none;
        }
        .sub-menu a:hover { opacity: 0.7; }

        /* EMPTY CART MESSAGE */
        .cart-empty {
          text-align: center;
          padding: 60px 20px 30px;
        }
        .cart-empty h2 {
          font-size: 26px;
          margin-bottom: 10px;
          letter-spacing: 1px;
        }
        .cart-empty p { font-size: 16px; margin-bottom: 25px; }
        .cart-empty a {
          display: inline-block;
          padding: 14px 28px;
          background: #000;
          color: #fff;
          font-size: 15px;
          text-decoration: none;
          border-radius: 4px;
        }

        /* CART ITEMS PANEL */
        .cart-items {
          max-width: 900px;
          margin: 20px auto 10px;
          padding: 20px 24px 80px;
          border-radius: 14px;
          box-shadow: 0 14px 40px rgba(0,0,0,0.06);
          background: #fff;
        }
        .cart-title {
          font-size: 24px;
          font-weight: 700;
          margin-bottom: 10px;
        }
        .cart-group-header {
          display: flex;
          align-items: center;
          gap: 8px;
          font-size: 14px;
          font-weight: 600;
          margin: 10px 0 6px;
        }
        .cart-group-pill {
          display: inline-block;
          padding: 4px 10px;
          border-radius: 999px;
          border: 1px solid #000;
          font-size: 11px;
          text-transform: uppercase;
        }
        .cart-item-row {
          display: grid;
          grid-template-columns: auto 80px 1fr auto;
          gap: 14px;
          padding: 10px 0 14px;
          border-bottom: 1px solid #eee;
          align-items: center;
        }
        .cart-item-select {
          display: flex;
          justify-content: center;
        }
        .cart-item-thumb {
          width: 72px;
          height: 72px;
          border-radius: 8px;
          overflow: hidden;
          background: #f4f4f4;
        }
        .cart-item-thumb img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
        .cart-item-main {
          display: flex;
          flex-direction: column;
          gap: 4px;
        }
        .cart-item-name {
          font-size: 14px;
          font-weight: 600;
        }
        .cart-item-meta {
          font-size: 12px;
          color: #666;
        }
        .cart-item-qty {
          display: flex;
          flex-direction: column;
          align-items: flex-end;
          gap: 8px;
        }
        .cart-qty-controls {
          display: inline-flex;
          align-items: center;
          gap: 10px;
          background: #111;
          padding: 6px 10px;
          border-radius: 12px;
        }
        .cart-qty-btn {
          width: 26px;
          height: 26px;
          border-radius: 8px;
          border: none;
          background: transparent;
          color: #fff;
          font-size: 16px;
          cursor: pointer;
        }
        .cart-qty-value {
          min-width: 24px;
          text-align: center;
          color: #fff;
          font-weight: 600;
        }
        .cart-remove-btn {
          margin-top: 6px;
          padding: 6px 10px;
          font-size: 12px;
          border-radius: 8px;
          border: 1px solid #ccc;
          background: #fff;
          cursor: pointer;
        }

        /* Checkout bar */
        .checkout-bar {
          position: sticky;
          bottom: 0;
          left: 0;
          right: 0;
          background: #fff;
          border-top: 1px solid #eee;
          padding: 12px 16px;
          display: none;
          align-items: center;
          justify-content: space-between;
          gap: 16px;
          z-index: 50;
        }
        .checkout-info {
          display: flex;
          align-items: center;
          gap: 10px;
          font-size: 14px;
        }
        .checkout-total {
          margin-left: auto;
          display: flex;
          align-items: center;
          gap: 12px;
          font-weight: 700;
        }
        .checkout-btn {
          padding: 10px 20px;
          border-radius: 999px;
          border: none;
          background: #000;
          color: #fff;
          font-weight: 700;
          cursor: pointer;
        }
        .checkout-btn:disabled {
          opacity: .4;
          cursor: default;
        }

        /* NEWSLETTER */
        .newsletter {
          padding: 60px 20px;
          text-align: center;
          border-top: 1px solid #eee;
        }
        .newsletter h3 { font-size: 20px; margin-bottom: 15px; }
        .newsletter form {
          max-width: 400px;
          margin: 0 auto;
        }
        .newsletter input {
          width: 100%;
          padding: 12px;
          font-size: 15px;
          border: 1px solid #ccc;
          border-radius: 4px;
          margin-bottom: 10px;
        }
        .newsletter button {
          width: 100%;
          padding: 12px;
          background: #000;
          color: #fff;
          font-size: 15px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
        }
        .newsletter p { font-size: 13px; margin-top: 10px; }

        /* FOOTER */
        footer {
          padding: 40px 20px;
          background: #f9f9f9;
          border-top: 1px solid #ddd;
          font-size: 14px;
          color: #333;
        }
        .footer-grid {
          max-width: 1200px;
          margin: 0 auto;
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
          gap: 25px;
        }
        .footer-grid h4 { font-weight: bold; margin-bottom: 10px; }
        .footer-bottom {
          text-align: center;
          margin-top: 30px;
          font-size: 13px;
          color: #666;
        }
        .footer-bottom a {
          text-decoration: none;
          color: #666;
        }
      </style>

      <a href="main.html">
        <img src="img/logo.png" class="logo" alt="">
      </a>

      <div class="nav-right">
        <a href="search.html"><i class="fa-solid fa-magnifying-glass"></i></a>
        <a href="sign-in.html"><i class="fa-regular fa-user"></i></a>
        <a href="cart.html" style="position:relative;">
          <i class="fa-solid fa-cart-shopping"></i>
          <span id="cart-counter" class="cart-count">0</span>
        </a>
      </div>
    </div>
  </header>

  <!-- CART CONTENT -->
  <main class="cart-page">
    <!-- VISIBLE WHEN CART HAS ITEMS -->
    <section id="cartItemsSection" class="cart-items" style="display:none;">
      <h1 class="cart-title">Shopping bag</h1>
      <div id="cartItemsList"></div>
    </section>

    <!-- Checkout bar -->
    <div id="checkoutBar" class="checkout-bar">
      <div class="checkout-info">
        <label>
          <input type="checkbox" id="selectAllCart">
          Select all
        </label>
        <span id="checkoutCount">0 item</span>
      </div>
      <div class="checkout-total">
        Total: <span id="checkoutTotal">₱0</span>
        <button id="checkoutBtn" class="checkout-btn" disabled>Check out</button>
      </div>
    </div>

    <!-- VISIBLE WHEN CART IS EMPTY -->
    <section class="cart-empty">
      <h2>YOUR SHOPPING BAG IS EMPTY</h2>
      <p>Get inspiration for your new wardrobe from the latest looks</p>
      <a href="main.html">SEE WHAT'S NEW</a>
    </section>

    <!-- NEWSLETTER -->
    <section class="newsletter">
      <h3>10% off your next purchase by subscribing to the newsletter</h3>
      <form>
        <input type="email" placeholder="E-mail">
        <button type="submit">SIGN UP NOW</button>
        <p>By subscribing, you confirm that you have read the <a href="#">Privacy Policy</a>.</p>
      </form>
    </section>

    <!-- FOOTER -->
    <footer>
      <div class="footer-grid">
        <div>
          <h4>CUSTOMER SERVICE</h4>
          <p><a href="#">Help</a></p>
          <p><a href="#">My Purchases</a></p>
          <p><a href="#">Returns</a></p>
        </div>
        <div>
          <h4>COMPANY</h4>
          <p><a href="#">About Us</a></p>
          <p><a href="#">Work for Trendify</a></p>
          <p><a href="#">Press</a></p>
        </div>
        <div>
          <h4>DISCOVER</h4>
          <p><a href="#">Responsibility</a></p>
          <p><a href="#">Stores</a></p>
          <p><a href="#">Site Map</a></p>
        </div>
        <div>
          <h4>FOLLOW US</h4>
          <p>Instagram · Facebook · YouTube</p>
          <p>TikTok · Spotify · Pinterest</p>
          <p>X · LinkedIn</p>
        </div>
        <div>
          <h4>LOCATION</h4>
          <p>PHILIPPINES ▼</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>
          <a href="#">Privacy Policy and Cookies</a> ·
          <a href="#">Terms and Conditions</a> ·
          <a href="#">Ethics Channel</a>
        </p>
        <p style="margin-top: 10px;">© 2025 Trendify. All rights reserved.</p>
      </div>
    </footer>

  </main>

  <script>
    // close dropdowns when clicking outside
    document.addEventListener("click", function(e) {
      const dropdowns = document.querySelectorAll(".dropdown");
      dropdowns.forEach(drop => {
        const toggle = drop.querySelector(".toggle");
        if (!drop.contains(e.target)) toggle.checked = false;
      });
    });

    // parse "₱1,295" -> 1295
    function parsePriceToNumber(p) {
      if (!p) return 0;
      return parseFloat(p.replace(/[₱,]/g, '')) || 0;
    }

    let selectedIndexes = new Set();

    function updateCartCounter() {
      const counter = document.getElementById('cart-counter');
      const cart = JSON.parse(localStorage.getItem('trendify_cart')) || [];
      const total = cart.reduce((sum, item) => sum + (item.qty || 1), 0);
      if (!counter) return;
      counter.innerText = total;
      counter.style.display = total > 0 ? 'block' : 'none';
    }

    function updateCheckoutSummary(cart) {
      const bar     = document.getElementById('checkoutBar');
      const totalEl = document.getElementById('checkoutTotal');
      const countEl = document.getElementById('checkoutCount');
      const btn     = document.getElementById('checkoutBtn');

      if (!bar || !totalEl || !countEl || !btn) return;

      if (!cart || cart.length === 0) {
        bar.style.display = 'none';
        selectedIndexes.clear();
        return;
      }

      bar.style.display = 'flex';

      let total = 0;
      let count = 0;

      cart.forEach((item, index) => {
        if (selectedIndexes.has(index)) {
          const priceNum = parsePriceToNumber(item.price);
          const qty = item.qty || 1;
          total += priceNum * qty;
          count += qty;
        }
      });

      totalEl.textContent = '₱' + total.toLocaleString('en-PH');
      countEl.textContent = count + (count === 1 ? ' item' : ' items');
      btn.disabled = count === 0;
    }

    // category label helper
    function getCategoryLabel(item) {
      const n = (item.name || '').toLowerCase();

      if (n.includes('croptop') || n.includes('blouse') || n.includes('top')) return 'Women tops';
      if (n.includes('dress')) return 'Women dresses';
      if (n.includes('skirt')) return 'Women skirts';
      if (n.includes('heels')) return 'Women heels';
      if (n.includes('handbag') || n.includes('shoulder bag') || n.includes('bag')) return 'Women bags';
      if (n.includes('bracelet') || n.includes('earrings') || n.includes('ring')) return 'Women jewelry';

      if (n.includes('enigma') || n.includes('universe') || n.includes('chicago') || n.includes('shirt')) return 'Men shirts';
      if (n.includes('jacket')) return 'Men jackets';
      if (n.includes('jeans') || n.includes('cargo')) return 'Men jeans';
      if (n.includes('jordan') || n.includes('shoes') || n.includes('sneaker')) return 'Men shoes';
      if (n.includes('backpack') || n.includes('crossbody') || n.includes('bag')) return 'Men bags';
      if (n.includes('necklace') || n.includes('watch') || n.includes('sun glasses')) return 'Men accessories';

      return 'Trendify';
    }

    function renderCartItemsPanel() {
      const cart = JSON.parse(localStorage.getItem('trendify_cart')) || [];
      const section = document.getElementById('cartItemsSection');
      const listEl  = document.getElementById('cartItemsList');
      const emptyEl = document.querySelector('.cart-empty');
      const selectAllEl = document.getElementById('selectAllCart');

      if (!section || !listEl) return;

      if (cart.length === 0) {
        section.style.display = 'none';
        if (emptyEl) emptyEl.style.display = 'block';
        updateCartCounter();
        updateCheckoutSummary(cart);
        return;
      }

      if (emptyEl) emptyEl.style.display = 'none';
      section.style.display = 'block';

      listEl.innerHTML = '';

      // AUTO‑SELECT ALL ITEMS ON LOAD
      selectedIndexes = new Set(cart.map((_, idx) => idx));

      cart.forEach((item, index) => {
        const groupLabel = getCategoryLabel(item);
        const row = document.createElement('div');
        row.innerHTML = `
          <div class="cart-group-header">
            <span class="cart-group-pill">${groupLabel}</span>
          </div>
          <div class="cart-item-row">
            <div class="cart-item-select">
              <input type="checkbox" class="cart-select-checkbox" data-index="${index}">
            </div>
            <div class="cart-item-thumb">
              <img src="${item.img}" alt="${item.name}">
            </div>
            <div class="cart-item-main">
              <div class="cart-item-name">${item.name}</div>
              <div class="cart-item-meta">
                ${item.price}${item.size ? ' · ' + item.size : ''}
              </div>
            </div>
            <div class="cart-item-qty">
              <div class="cart-qty-controls">
                <button class="cart-qty-btn minus">−</button>
                <span class="cart-qty-value">${item.qty || 1}</span>
                <button class="cart-qty-btn plus">+</button>
              </div>
              <button class="cart-remove-btn" data-index="${index}">Remove</button>
            </div>
          </div>
        `;

        const checkbox = row.querySelector('.cart-select-checkbox');
        const minusBtn  = row.querySelector('.cart-qty-btn.minus');
        const plusBtn   = row.querySelector('.cart-qty-btn.plus');
        const valEl     = row.querySelector('.cart-qty-value');
        const removeBtn = row.querySelector('.cart-remove-btn');

        // checked by default
        checkbox.checked = true;

        checkbox.addEventListener('change', () => {
          if (checkbox.checked) {
            selectedIndexes.add(index);
          } else {
            selectedIndexes.delete(index);
          }
          if (selectAllEl) {
            selectAllEl.checked = cart.length > 0 && cart.every((_, i) => selectedIndexes.has(i));
          }
          updateCheckoutSummary(cart);
        });

        minusBtn.addEventListener('click', () => {
          let q = parseInt(valEl.textContent) || 1;
          if (q > 1) {
            q--;
            valEl.textContent = q;
            item.qty = q;
            localStorage.setItem('trendify_cart', JSON.stringify(cart));
            updateCartCounter();
            updateCheckoutSummary(cart);
          }
        });

        plusBtn.addEventListener('click', () => {
          let q = parseInt(valEl.textContent) || 1;
          q++;
          valEl.textContent = q;
          item.qty = q;
          localStorage.setItem('trendify_cart', JSON.stringify(cart));
          updateCartCounter();
          updateCheckoutSummary(cart);
        });

        removeBtn.addEventListener('click', () => {
          const newCart = cart.filter((_, i) => i !== index);
          localStorage.setItem('trendify_cart', JSON.stringify(newCart));
          selectedIndexes.delete(index);
          updateCartCounter();
          renderCartItemsPanel();
        });

        listEl.appendChild(row);
      });

      if (selectAllEl) {
        selectAllEl.onchange = () => {
          if (selectAllEl.checked) {
            selectedIndexes = new Set(cart.map((_, idx) => idx));
          } else {
            selectedIndexes.clear();
          }
          document.querySelectorAll('.cart-select-checkbox').forEach(cb => {
            cb.checked = selectAllEl.checked;
          });
          updateCheckoutSummary(cart);
        };
        // select-all checked because everything is selected
        selectAllEl.checked = true;
      }

      updateCheckoutSummary(cart);
    }

    document.getElementById('checkoutBtn').addEventListener('click', () => {
      const cart = JSON.parse(localStorage.getItem('trendify_cart')) || [];
      const selectedItems = cart.filter((_, idx) => selectedIndexes.has(idx));
      if (selectedItems.length === 0) return;

      // Save selected items for checkout flow
      localStorage.setItem('trendify_checkout', JSON.stringify(selectedItems));
      // Later you can build checkout.html; for now this is the target
      window.location.href = 'checkout.html';
    });

    updateCartCounter();
    renderCartItemsPanel();
  </script>

</body>
</html>
